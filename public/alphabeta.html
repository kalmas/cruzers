<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Cruzers Songbook</title>
		<link rel="stylesheet" href="css/cruz1.min.css" />
		<link rel="stylesheet" href="css/custom.css" />
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile.structure-1.1.1.min.css" />
		<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>
		<script type="text/javascript">

			jQuery(document).bind('pageinit', function(){
				function clearSuggestions(){
					$('#searchMessage').empty();
					$('#suggestions-list').empty();
				}
				function hideFooter(){
					$('#footer').hide();
				}
				function showFooter(){
					$('#footer').show();
				}
				var $searchBox = $("#songsSearchBox")
				$searchBox.focus(hideFooter);
				$searchBox.blur(showFooter);
				$searchBox.keydown(clearSuggestions);
				$(".ui-input-clear").click(clearSuggestions);

				$("#songsSearchBox").autocomplete({
					source: function(request, response) {
						$.ajax({
							url: '/cruzers/suggest/' + encodeURI(request.term),
							dataType: 'json',
							beforeSend:function(){
								clearSuggestions();
								$.mobile.showPageLoadingMsg();
							},
							complete:function(){
								$.mobile.hidePageLoadingMsg();
							},
							success:function(data) {
								if(data.length == 0){
									$('#searchMessage').text("No matching songs found :,(");
								}
								response($.map(data, function(item){
									return {
										label: item.title,
										value: item.title,
										data: item
									}
								}));
							}
						});
					},
					appendTo: "#suggestions",
					minLength: 2,
					open: function (event, ui) {
						$("div#suggestions").show();
						$("ul#suggestions-list").listview('refresh');
	                },
	                search: function (event, ui) {
	                    $("ul#suggestions-list li.ac").remove();
	                }

				})
				.data("autocomplete")._renderItem = function(ul, item) {
					$('<li class="ac"><a href="#song-info" class="ui-link-inherit" data-transition="slide">' + 
							'<h3 class="ui-li-heading">' + item.label + '</h3>' +
							'<p class="ui-li-desc">' + item.data.artist + '</p>' +
							'</a></li>').appendTo("ul#suggestions-list")
							.bind("click", item, function (event){
								$("#song-title").text(item.data.title);
								$("#song-artist").text(item.data.artist);
								$("#song-code").text(item.data.code);
							});
	                return null;
				};
			});
		</script>
		<script type="text/javascript">
		  	var _gaq = _gaq || [];
		 	_gaq.push(['_setAccount', 'UA-35175562-1']);
		  	_gaq.push(['_trackPageview']);
		
		  	(function() {
		    		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		    		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		    		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  	})();
		</script>

	</head>
	<body>
			
		<div data-role="page" id="mainPage" data-theme="a">
			<div data-role="header" data-position="fixed" data-id="foo">
				<h1>Cruzers Songbook</h1>
			</div>
			<div data-role="content" data-theme="a">
				<input type="search" id="songsSearchBox" class="ui-input-text" 
					placeholder="Search by Song or Artist" />
			</div>
			<div data-role="content" data-theme="a" id="suggestions">
				<ul data-role="listview" class="ui-listview" id="suggestions-list"></ul>
				<div>
					<h3 id="searchMessage"></h3>
				</div>
			</div>
			<div data-role="footer" data-position="fixed" data-id="bar" id="footer">
				<div data-role="navbar">
					<ul>
						<li><a href="#about">About</a></li>
					</ul>
				</div>
			</div>		
		</div>
		<div data-role="page" id="song-info" data-theme="a">
			<div data-role="header" data-position="fixed" data-id="foo">
				<a href="#mainPage" data-icon="arrow-l">Back</a>
				<h1>Cruzers Songbook</h1>
			</div>
			<h1 class="text-center space-none-bottom" id="song-title"></h1>
			<h3 class="text-center space-none-top" id="song-artist"></h3>
			<p class="text-center font-xxlarge font-bold" id="song-code"></p>
			<div data-role="footer" data-position="fixed" data-id="bar">
				<div data-role="navbar">
					<ul>
						<li><a href="#about">About</a></li>
					</ul>
				</div>
			</div>
		</div>
		<div data-role="page" id="about" data-theme="a">
			<div data-role="header" data-position="fixed" data-id="foo">
				<a href="#mainPage" data-icon="arrow-l">Back</a>
				<h1>Cruzers Songbook</h1>
			</div>
			<p class="text-center font-bold">This site is presented as a love letter to the best bar 
			in Norfolk (Karaoke or otherwise). <br />Use it wisely and tip well.</p>
			<p class="text-center">Site by Kyle (<a href="http://twitter.com/kylealmas">@kylealmas</a>)</p>
			<p class="text-center">Artwork by Greg (<a href="http://thesebearsarehappy.com">thesebearsarehappy.com</a>)</p>
			<p class="text-center">Improvements coming soon, including a 
			Correct-A-Song feature, because I know the data is bad. 
			You can <a href="http://github.com/kalmas/cruzers">fork the code
			here</a>, if you're into that sorta thing.</p>
		</div>

		
</body>

	
</html>
